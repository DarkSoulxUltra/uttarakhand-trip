<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uttarakhand Group Trip Planner</title>

<style>
body{margin:0;font-family:system-ui;background:#020617;color:#67e8f9}
h1{text-align:center;margin:8px 0}
.container{max-width:1200px;margin:auto;padding:12px;padding-bottom:160px}
.stickyTop{position:sticky;top:0;background:#020617;z-index:5}

.routeBox{border:1px solid #164e63;border-radius:14px;padding:12px;margin-bottom:8px}
.progressText{text-align:center;color:#22d3ee;font-weight:600;margin-bottom:4px}

.routeLine{position:relative;display:flex;justify-content:space-between;align-items:center;height:40px}
.routeLine::before{content:'';position:absolute;left:0;right:0;top:50%;height:3px;background:#164e63}
.node{width:16px;height:16px;background:#164e63;border-radius:50%;cursor:pointer;z-index:2}
.node.active{background:#22d3ee}
.vehicle{position:absolute;top:-22px;transition:.6s cubic-bezier(.4,0,.2,1)}

.routeLabels{display:flex;justify-content:space-between;font-size:12px;margin-top:4px;opacity:.8}

.layout{display:flex;flex-wrap:wrap;gap:12px}
.timeline{flex:1;min-width:220px}
.content{flex:3;min-width:280px}

.card{border:1px solid #164e63;border-radius:10px;padding:10px;margin-bottom:8px;cursor:pointer}
.card.active{background:#022c22;border-color:#22d3ee}

.imageWrap{border:1px solid #164e63;border-radius:12px;overflow:hidden;background:#020617}
.imageWrap img{width:100%;height:auto;max-height:320px;object-fit:contain}

.gallery{display:flex;gap:8px;overflow-x:auto;padding:6px 0}
.gallery img{height:60px;border-radius:8px;border:1px solid #164e63;cursor:pointer}

details{border:1px solid #164e63;border-radius:10px;padding:8px;margin:8px 0}
summary{cursor:pointer;font-weight:600}

.mobileNav{
  position:fixed;bottom:0;left:0;right:0;
  background:#020617;border-top:1px solid #164e63;
  display:flex;justify-content:space-around;padding:8px;z-index:10;
}

input,select{padding:6px;border-radius:6px;border:none;margin:4px}
button{background:#22d3ee;border:none;border-radius:6px;padding:6px 12px;font-weight:600;cursor:pointer}

iframe{width:100%;height:220px;border-radius:10px;border:1px solid #164e63;margin-top:6px}

@media(max-width:768px){
  .layout{flex-direction:column}
  .timeline{order:3}
}
</style>
</head>

<body>

<div class="container">

<h1>Uttarakhand Group Trip Planner</h1>

<div class="stickyTop">
  <div class="routeBox">
    <div class="progressText" id="progressText"></div>
    <div class="routeLine">
      <div id="vehicle" class="vehicle">üöå</div>
      <div class="node" onclick="select(0)"></div>
      <div class="node" onclick="select(1)"></div>
      <div class="node" onclick="select(2)"></div>
      <div class="node" onclick="select(3)"></div>
      <div class="node" onclick="select(4)"></div>
    </div>
    <div class="routeLabels">
      <span>Delhi</span><span>Haridwar</span><span>Rishikesh</span><span>Dehradun</span><span>Mussoorie</span>
    </div>
  </div>
</div>

<div class="layout">
  <div class="timeline" id="timeline"></div>
  <div class="content" id="content"></div>
</div>

</div>

<div class="mobileNav">
  <button onclick="prev()">‚èÆ Prev</button>
  <button onclick="next()">Next ‚è≠</button>
</div>

<script>
// ---------------- STORAGE ----------------
let participants = JSON.parse(localStorage.getItem("participants")) || ["You","Spouse"];
let expenses = JSON.parse(localStorage.getItem("expenses")) || [];

// ---------------- DATES ----------------
const tripDates=[
 "Sun",
 "Mon",
 "Tue",
 "Wed",
 "Thu"
];

// ---------------- ITINERARY ----------------
const days=[
{
city:"Delhi Arrival",
title:"Station ‚Üí Dinner ‚Üí Bus Transfer",
schedule:{morning:"‚Äî",afternoon:"Train journey",evening:"Freshen up + Volvo Bus"},
luggage:["Cloak room / retiring room at station","Bus luggage compartment"],
steps:[
"Arrive H Nizamuddin ~7 PM",
"Freshen up at station washroom / retiring room",
"Dinner at food court",
"Cab/Metro to Kashmere Gate ISBT (45‚Äì60 min buffer)",
"Board Volvo to Haridwar (10‚Äì11 PM)"
],
buffers:["30‚Äì45 min transfer buffer","15 min boarding buffer"],
food:["Station food court","ISBT McD / stalls"],
tea:["ISBT tea stalls"],
map:"https://www.google.com/maps?q=H+Nizamuddin+to+Kashmere+Gate+ISBT&output=embed",
images:["images/delhi_bus.jpg"]
},

{
city:"Haridwar",
title:"Temples + Ganga Aarti",
schedule:{morning:"Mansa Devi Ropeway",afternoon:"Rest + Lunch",evening:"Ganga Aarti"},
luggage:["Hotel reception storage"],
steps:[
"Bus drop early morning",
"Auto to hotel, rest 2‚Äì3 hrs",
"Ropeway to Mansa Devi",
"Optional Chandi Devi",
"Evening Ganga Aarti at Har Ki Pauri",
"Market walk & dinner"
],
buffers:["Extra rest after night travel"],
food:["Chotiwala","Hoshiyar Puri"],
tea:["Tea near ghat"],
map:"https://www.google.com/maps?q=Har+Ki+Pauri+Haridwar&output=embed",
images:["images/haridwar_aarti.jpg"]
},

{
city:"Rishikesh ‚Üí Dehradun",
title:"Shiva Statue, Caf√© & FRI",
schedule:{morning:"Rishikesh sightseeing",afternoon:"Caf√© + Drive",evening:"FRI Garden"},
luggage:["Carry luggage in cab","Hotel check-in before FRI"],
steps:[
"Cab Haridwar ‚Üí Rishikesh (1.5 hrs)",
"Visit Shiva Statue & Ram Jhula",
"Optional Parmarth Niketan ghat",
"Lunch at riverside caf√©",
"Drive to Dehradun (1 hr)",
"Hotel check-in, then FRI walk"
],
buffers:["Bridge traffic buffer","Hotel check-in wait"],
food:["Little Buddha Cafe","Free Spirit Cafe"],
tea:["Tea stalls near FRI gate"],
map:"https://www.google.com/maps?q=Haridwar+to+Rishikesh+to+Dehradun&output=embed",
images:["images/rishikesh_shiva.jpg","images/fri_dehradun.jpg"]
},

{
city:"Dehradun ‚Üí Mussoorie",
title:"Robber‚Äôs Cave ‚Üí Hotel ‚Üí Mall Road",
schedule:{morning:"Robber‚Äôs Cave",afternoon:"Hotel + Hill Drive",evening:"Mall Road"},
luggage:["Leave luggage at Dehradun hotel","Carry after checkout to Mussoorie"],
steps:[
"Cab to Robber‚Äôs Cave (carry towel + spare clothes)",
"Return to Dehradun hotel",
"Freshen up, pack luggage, checkout",
"Drive to Mussoorie (1.5 hrs)",
"Check-in Mussoorie hotel",
"Company Garden + Mall Road"
],
buffers:["Hill road slow traffic","Hotel check-in wait"],
food:["Mall Road caf√©s","Lovely Omelette Centre"],
tea:["View-point tea stalls"],
map:"https://www.google.com/maps?q=Robbers+Cave+Dehradun+to+Mussoorie+Mall+Road&output=embed",
images:["images/robbers_cave.jpg","images/company_garden.jpg"]
},

{
city:"Mussoorie",
title:"Kempty Falls & Camel‚Äôs Back Road",
schedule:{morning:"Kempty Falls",afternoon:"Rest + Lunch",evening:"Sunset walk"},
luggage:["Hotel storage till evening departure"],
steps:[
"Early cab to Kempty Falls",
"Optional ropeway",
"Return to hotel, lunch & rest",
"Evening Camel‚Äôs Back Road walk",
"Caf√© hopping on Mall Road"
],
buffers:["Crowd at falls","Return traffic"],
food:["Cafe Ivy","Kalsang Friends Corner"],
tea:["Camel‚Äôs Back Road vendors"],
map:"https://www.google.com/maps?q=Kempty+Falls+Mussoorie&output=embed",
images:["images/kempty_falls.jpg","images/camels_back.jpg"]
}
];

let active=0,img=0;
const timeline=document.getElementById("timeline");
const content=document.getElementById("content");

// ---------------- SETTLEMENT ----------------
function calcSettlement(){
 const paid={};
 participants.forEach(p=>paid[p]=0);
 expenses.forEach(e=>paid[e.paidBy]+=e.amount);

 const total=expenses.reduce((a,b)=>a+b.amount,0);
 const share=participants.length?total/participants.length:0;

 const balance={};
 participants.forEach(p=>balance[p]=Math.round(paid[p]-share));
 return {paid,balance,total,share:Math.round(share)};
}

// ---------------- RENDER ----------------
function buildTimeline(){
 timeline.innerHTML="";
 days.forEach((d,i)=>{
  let div=document.createElement("div");
  div.className="card"+(i===active?" active":"");
  div.innerHTML=`<b>${tripDates[i]}</b><br>${d.city}`;
  div.onclick=()=>select(i);
  timeline.appendChild(div);
 });
}

function render(){
 const d=days[active];
 const {balance,total,share}=calcSettlement();

 content.innerHTML=`
 <h2>${d.title}</h2>

 <div class="imageWrap"><img src="${d.images[img]}"></div>
 <div class="gallery">${d.images.map((x,i)=>`<img src="${x}" onclick="img=${i};render()">`).join("")}</div>

 <details open><summary>üìÖ Schedule</summary>
 <b>Morning:</b> ${d.schedule.morning}<br>
 <b>Afternoon:</b> ${d.schedule.afternoon}<br>
 <b>Evening:</b> ${d.schedule.evening}
 </details>

 <details open><summary>üß≠ Step-by-Step Route</summary><ul>${d.steps.map(x=>`<li>${x}</li>`).join("")}</ul></details>
 <details><summary>üìç Luggage</summary><ul>${d.luggage.map(x=>`<li>${x}</li>`).join("")}</ul></details>
 <details><summary>üïí Buffers</summary><ul>${d.buffers.map(x=>`<li>${x}</li>`).join("")}</ul></details>
 <details><summary>üç¥ Food Stops</summary><ul>${d.food.map(x=>`<li>${x}</li>`).join("")}</ul></details>
 <details><summary>‚òï Tea Stops</summary><ul>${d.tea.map(x=>`<li>${x}</li>`).join("")}</ul></details>

 <details><summary>üó∫ Route Map</summary><iframe src="${d.map}" loading="lazy"></iframe></details>

 <hr>

 <details open><summary>üë• Participants</summary>
 <input id="newName" placeholder="Add name">
 <button onclick="addPerson()">Add</button>
 <ul>${participants.map((p,i)=>`<li>${p} <button onclick="removePerson(${i})">‚ùå</button></li>`).join("")}</ul>
 </details>

 <details open><summary>üí≥ Add Expense</summary>
 <input id="expTitle" placeholder="Expense name">
 <input id="expAmt" type="number" placeholder="Amount ‚Çπ">
 <select id="paidBy">${participants.map(p=>`<option>${p}</option>`).join("")}</select>
 <button onclick="addExpense()">Add</button>
 </details>

 <details open><summary>üìä Expense & Settlement</summary>
 Total: ‚Çπ${total} | Per Person: ‚Çπ${share}
 <ul>
 ${Object.keys(balance).map(p=>{
   if(balance[p]>0) return `<li>${p} should receive ‚Çπ${balance[p]}</li>`;
   if(balance[p]<0) return `<li>${p} should pay ‚Çπ${Math.abs(balance[p])}</li>`;
   return `<li>${p} settled</li>`;
 }).join("")}
 </ul>
 <button onclick="shareWA()">üì≤ Share on WhatsApp</button>
 </details>
 `;

 document.getElementById("progressText").innerText=`${tripDates[active]} ‚Äî ${d.city}`;
 document.querySelectorAll(".card").forEach((c,i)=>c.classList.toggle("active",i===active));
 document.querySelectorAll(".node").forEach((n,i)=>n.classList.toggle("active",i===active));
 document.getElementById("vehicle").style.left=`calc(${active*(100/(days.length-1))}% - 10px)`;

 buildTimeline();
 saveData();
}

// ---------------- ACTIONS ----------------
function addPerson(){
 const n=document.getElementById("newName").value.trim();
 if(!n) return;
 participants.push(n);
 render();
}

function removePerson(i){
 const name=participants[i];
 expenses=expenses.filter(e=>e.paidBy!==name);
 participants.splice(i,1);
 render();
}

function addExpense(){
 const t=document.getElementById("expTitle").value;
 const a=parseInt(document.getElementById("expAmt").value);
 const p=document.getElementById("paidBy").value;
 if(!t||!a) return alert("Enter name and amount");
 expenses.push({title:t,amount:a,paidBy:p});
 render();
}

function saveData(){
 localStorage.setItem("participants",JSON.stringify(participants));
 localStorage.setItem("expenses",JSON.stringify(expenses));
}

function shareWA(){
 const {balance,total,share}=calcSettlement();
 let msg=`Uttarakhand Trip Settlement\nTotal: ‚Çπ${total}\nPer Person: ‚Çπ${share}\n\nBalances:\n`;
 Object.keys(balance).forEach(p=>{
  if(balance[p]>0) msg+=`${p} gets ‚Çπ${balance[p]}\n`;
  else if(balance[p]<0) msg+=`${p} pays ‚Çπ${Math.abs(balance[p])}\n`;
  else msg+=`${p} settled\n`;
 });
 window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`);
}

// ---------------- NAV ----------------
function select(i){active=i;img=0;render();}
function next(){active=(active+1)%days.length;render();}
function prev(){active=(active-1+days.length)%days.length;render();}

render();
</script>
</body>
</html>
