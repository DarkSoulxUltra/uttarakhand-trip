<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Uttarakhand Trip Planner</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
body{
  margin:0;
  font-family:system-ui;
  background:#020617;
  color:#67e8f9;
}
h1{text-align:center;margin:16px}

/* ROUTE */
.routeBox{
  border:1px solid #164e63;
  border-radius:14px;
  padding:14px;
  margin:12px;
}
.routeTitle{
  text-align:center;
  font-weight:600;
  margin-bottom:8px;
}
.routeTrack{
  position:relative;
  height:46px;
}
.routeLine{
  position:absolute;
  top:50%;
  left:0;
  right:0;
  height:2px;
  background:#164e63;
}
.routeProgress{
  position:absolute;
  top:50%;
  left:0;
  height:2px;
  background:#22d3ee;
  width:0%;
  transition:width .4s ease;
}
.routeDots{
  position:absolute;
  top:50%;
  left:0;
  right:0;
  display:flex;
  justify-content:space-between;
}
.node{
  width:14px;
  height:14px;
  background:#164e63;
  border-radius:50%;
  cursor:pointer;
}
.node.active{background:#22d3ee}
.bus{
  position:absolute;
  top:0;
  transform:translateX(-50%);
  transition:left .4s ease;
}

/* TOGGLE */
.toggleWrap{
  display:flex;
  align-items:center;
  gap:10px;
  justify-content:flex-end;
  margin-bottom:8px;
}
.switch{
  position:relative;
  width:50px;
  height:24px;
}
.switch input{display:none}
.slider{
  position:absolute;
  inset:0;
  background:#334155;
  border-radius:20px;
  cursor:pointer;
}
.slider:before{
  content:"";
  position:absolute;
  height:18px;
  width:18px;
  left:3px;
  top:3px;
  background:#fff;
  border-radius:50%;
  transition:.3s;
}
input:checked + .slider{
  background:#22d3ee;
}
input:checked + .slider:before{
  transform:translateX(26px);
}

/* GRID + CARDS */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:12px;
  padding:12px;
}
.card{
  border:1px solid #164e63;
  border-radius:12px;
  padding:10px;
}
.cardHeader{
  font-weight:600;
  cursor:pointer;
  margin-bottom:6px;
}
.cardBody{display:none}
.card.open .cardBody{display:block}

input,select,textarea,button{
  width:100%;
  margin:4px 0;
  padding:6px;
  border-radius:6px;
  border:none;
}
button{
  background:#22d3ee;
  font-weight:600;
  cursor:pointer;
}

iframe{
  width:100%;
  border:0;
  border-radius:8px;
}
</style>
</head>

<body>
<h1>Uttarakhand Trip Planner</h1>

<div class="routeBox">
  <div class="toggleWrap">
    <span>Collapse</span>
    <label class="switch">
      <input type="checkbox" id="expandToggle">
      <span class="slider"></span>
    </label>
    <span>Expand</span>
  </div>

  <div class="routeTitle" id="routeTitle"></div>

  <div class="routeTrack">
    <div class="routeLine"></div>
    <div class="routeProgress" id="routeProgress"></div>
    <div class="bus" id="bus">üöå</div>
    <div class="routeDots" id="routeDots"></div>
  </div>
</div>

<div class="grid" id="content"></div>

<script>
/* ---------------- STATE ---------------- */
var activeDay = 0;
var cardsExpanded = false;
var openCards = new Set();

var participants = ["Sahil","Patil"];
var expenses = [];
var logs = [];

/* ---------------- DAYS (6) ---------------- */
var days = [
  {
    title:"Sun ‚Äî Delhi ‚Üí Haridwar",
    steps:["Arrive Delhi","Bus to Haridwar","Hotel check-in","Ganga Aarti"],
    hotel:{name:"Hotel Ganga Lahari",map:"https://maps.google.com/maps?q=Hotel%20Ganga%20Lahari&output=embed"},
    food:["Local chai","Chotiwala"],
    emergency:["Ambulance 108","Police 112","District Hospital Haridwar"]
  },
  {
    title:"Mon ‚Äî Haridwar ‚Üí Rishikesh",
    steps:["Morning Aarti","Travel to Rishikesh","Explore ghats"],
    hotel:{name:"Aloha on the Ganges",map:"https://maps.google.com/maps?q=Aloha%20on%20the%20Ganges&output=embed"},
    food:["German Bakery","Ganga View Cafe"],
    emergency:["Ambulance 108","Police 112","AIIMS Rishikesh"]
  },
  {
    title:"Tue ‚Äî Rishikesh",
    steps:["Yoga","Rafting","Cafe hopping"],
    hotel:{name:"Same Hotel",map:"https://maps.google.com/maps?q=Rishikesh&output=embed"},
    food:["Little Buddha Cafe"],
    emergency:["AIIMS Rishikesh"]
  },
  {
    title:"Wed ‚Äî Rishikesh",
    steps:["Explore temples","Free day"],
    hotel:{name:"Same Hotel",map:"https://maps.google.com/maps?q=Rishikesh&output=embed"},
    food:["Local snacks"],
    emergency:["AIIMS Rishikesh"]
  },
  {
    title:"Thu ‚Äî Rishikesh ‚Üí Dehradun",
    steps:["Travel to Dehradun","Deer Park","Drona Ashram"],
    hotel:{name:"Dehradun Hotel",map:"https://maps.google.com/maps?q=Dehradun&output=embed"},
    food:["Bakery"],
    emergency:["District Hospital Dehradun"]
  },
  {
    title:"Fri ‚Äî Mussoorie ‚Üí Delhi",
    steps:["Sahastradhara","Return to Delhi"],
    hotel:{name:"‚Äî",map:"https://maps.google.com/maps?q=Mussoorie&output=embed"},
    food:["Tea"],
    emergency:["Police 112"]
  }
];

/* ---------------- SETTLEMENT ---------------- */
function calculateSettlement(){
  var total = 0;
  var paid = {};
  participants.forEach(p=>paid[p]=0);

  expenses.forEach(e=>{
    total += e.amount;
    paid[e.paidBy] += e.amount;
  });

  var share = participants.length ? total/participants.length : 0;
  var settlement = {};
  participants.forEach(p=>{
    settlement[p] = Math.round(paid[p]-share);
  });

  return {total:total,share:share,settlement:settlement};
}

/* ---------------- RENDER ---------------- */
function render(){
  document.getElementById("expandToggle").checked = cardsExpanded;
  document.getElementById("routeTitle").innerText = days[activeDay].title;

  /* ROUTE DOTS */
  var dots = document.getElementById("routeDots");
  dots.innerHTML="";
  days.forEach(function(_,i){
    var n=document.createElement("div");
    n.className="node"+(i===activeDay?" active":"");
    n.onclick=function(){activeDay=i;render();};
    dots.appendChild(n);
  });

  document.getElementById("routeProgress").style.width =
    (activeDay/(days.length-1))*100+"%";
  document.getElementById("bus").style.left =
    (activeDay/(days.length-1))*100+"%";

  var d = days[activeDay];
  var s = calculateSettlement();

  function card(id,title,body){
    var open = cardsExpanded || openCards.has(id);
    return `
      <div class="card ${open?"open":""}">
        <div class="cardHeader" onclick="toggleCard('${id}')">${title}</div>
        <div class="cardBody">${body}</div>
      </div>`;
  }

  document.getElementById("content").innerHTML = `
    ${card("steps","üß≠ Step-by-step","<ul>"+d.steps.map(x=>"<li>"+x+"</li>").join("")+"</ul>")}
    ${card("hotel","üè® Hotel","<b>"+d.hotel.name+"</b><iframe src='"+d.hotel.map+"' height='180'></iframe>")}
    ${card("food","‚òï Food & Snacks","<ul>"+d.food.map(x=>"<li>"+x+"</li>").join("")+"</ul>")}
    ${card("emergency","üöë Emergency","<ul>"+d.emergency.map(x=>"<li>"+x+"</li>").join("")+"</ul>")}
    ${card("expenses","üí≥ Expenses",`
      <input id="et" placeholder="Title">
      <input id="ea" type="number" placeholder="Amount">
      <select id="ep">${participants.map(p=>"<option>"+p+"</option>").join("")}</select>
      <button onclick="addExpense()">Add</button><hr>
      ${expenses.map((e,i)=>`${e.title} ‚Çπ${e.amount} (${e.paidBy})
        <button onclick="delExpense(${i})">‚ùå</button>`).join("<br>")}
    `)}
    ${card("settlement","üìä Settlement",`
      <b>Total:</b> ‚Çπ${s.total}<br>
      <b>Per Person:</b> ‚Çπ${Math.round(s.share)}<hr>
      ${participants.map(p=>{
        var v=s.settlement[p];
        return v>0?`üü¢ ${p} gets ‚Çπ${v}`:
               v<0?`üî¥ ${p} pays ‚Çπ${-v}`:
               `‚ö™ ${p} settled`;
      }).join("<br>")}
    `)}
    ${card("logs","üìú Logs",`
      <button onclick="clearLogs()">Clear Logs</button><hr>
      ${logs.length?logs.join("<br>"):"No logs"}
    `)}
  `;
}

/* ---------------- ACTIONS ---------------- */
function toggleCard(id){
  if(openCards.has(id)) openCards.delete(id);
  else openCards.add(id);
  render();
}
function addExpense(){
  var t=et.value;
  var a=parseInt(ea.value);
  var p=ep.value;
  if(!t||!a)return;
  expenses.push({title:t,amount:a,paidBy:p});
  logs.unshift(p+" added ‚Çπ"+a+" for "+t);
  render();
}
function delExpense(i){
  var e=expenses.splice(i,1)[0];
  logs.unshift("Removed ‚Çπ"+e.amount+" for "+e.title);
  render();
}
function clearLogs(){
  logs=[];
  render();
}

document.getElementById("expandToggle").onchange=function(e){
  cardsExpanded=e.target.checked;
  render();
};

document.addEventListener("DOMContentLoaded",render);
</script>
</body>
</html>
