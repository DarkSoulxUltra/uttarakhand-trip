<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Uttarakhand Trip Planner</title>

<style>
:root{
  --bg:#020617;
  --card:#020617;
  --border:#164e63;
  --accent:#22d3ee;
  --muted:#67e8f9;
}
body{
  margin:0;
  font-family:system-ui;
  background:var(--bg);
  color:var(--muted);
}
h1{
  text-align:center;
  margin:12px 0;
  color:var(--accent);
}
.container{
  max-width:1400px;
  margin:auto;
  padding:12px;
}

/* ROUTE BAR */
.routeBox{
  position:relative;
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px 12px 18px;
  margin-bottom:14px;
}
.routeTitle{
  text-align:center;
  font-weight:600;
  color:var(--accent);
  margin-bottom:8px;
}
.routeActions{
  position:absolute;
  top:10px;
  right:12px;
}
.routeLine{
  position:relative;
  display:flex;
  justify-content:space-between;
  align-items:center;
  height:40px;
}
.routeLine::before{
  content:"";
  position:absolute;
  left:0; right:0;
  top:50%;
  height:3px;
  background:var(--border);
}
.node{
  width:18px;
  height:18px;
  background:var(--border);
  border-radius:50%;
  cursor:pointer;
  position:relative;
}
.node.active{
  background:var(--accent);
  box-shadow:0 0 10px var(--accent);
}
.node:hover::after{
  content:attr(data-tip);
  position:absolute;
  top:-28px;
  left:50%;
  transform:translateX(-50%);
  background:#020617;
  border:1px solid var(--border);
  padding:2px 6px;
  font-size:11px;
  border-radius:4px;
  white-space:nowrap;
}
.vehicle{
  position:absolute;
  top:-24px;
  transition:.4s;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
}
@media(max-width:1100px){ .grid{grid-template-columns:repeat(2,1fr);} }
@media(max-width:600px){ .grid{grid-template-columns:1fr;} }

/* CARDS */
.sectionCard{
  border:1px solid var(--border);
  border-radius:12px;
  background:var(--card);
}
.sectionHeader{
  padding:10px;
  font-weight:600;
  cursor:pointer;
  border-bottom:1px solid var(--border);
}
.sectionBody{
  padding:10px;
  display:none;
}
.sectionCard.expanded .sectionBody{
  display:block;
}

/* INPUTS */
input, textarea, select{
  width:100%;
  margin:4px 0;
  padding:6px;
  border-radius:6px;
  border:none;
}
button{
  background:var(--accent);
  border:none;
  border-radius:6px;
  padding:6px 10px;
  cursor:pointer;
}
.log{font-size:13px;margin-bottom:4px;}
</style>
</head>

<body>
<div class="container">
<h1>Uttarakhand Trip Planner</h1>

<div class="routeBox">
  <div class="routeTitle" id="routeTitle"></div>
  <div class="routeActions">
    <label>
      <input type="checkbox" id="expandToggle"> Expand all
    </label>
  </div>
  <div class="routeLine">
    <div id="vehicle" class="vehicle">üöå</div>
    <div class="node" onclick="selectDay(0)"></div>
    <div class="node" onclick="selectDay(1)"></div>
    <div class="node" onclick="selectDay(2)"></div>
    <div class="node" onclick="selectDay(3)"></div>
    <div class="node" onclick="selectDay(4)"></div>
    <div class="node" onclick="selectDay(5)"></div>
  </div>
</div>

<div class="grid" id="content"></div>
</div>

<script>
const tripDates=["Sun","Mon","Tue","Wed","Thu","Fri"];

const days=[
{city:"Delhi ‚Üí Haridwar",steps:["Arrive Delhi","Bus to Haridwar","Hotel check-in","Ganga Aarti"],route:"https://www.google.com/maps?q=Delhi+to+Haridwar&output=embed",hotel:{name:"Hotel Ganga Lahari",map:"#"},emergency:["Ambulance:108","Police:112"],food:["Local chai"]},
{city:"Haridwar ‚Üí Rishikesh",steps:["Morning Aarti","Travel"],route:"https://www.google.com/maps?q=Haridwar+to+Rishikesh&output=embed",hotel:{name:"Aloha on the Ganges",map:"#"},emergency:["AIIMS Rishikesh"],food:["German Bakery"]},
{city:"Rishikesh",steps:["Ram Jhula","Cafes"],route:"https://www.google.com/maps?q=Rishikesh&output=embed",hotel:{name:"Tapovan Stay",map:"#"},emergency:["AIIMS"],food:["Beatles Cafe"]},
{city:"Rishikesh",steps:["Rafting"],route:"https://www.google.com/maps?q=Rishikesh+rafting&output=embed",hotel:{name:"Tapovan Stay",map:"#"},emergency:["AIIMS"],food:["Snacks"]},
{city:"Rishikesh ‚Üí Dehradun",steps:["Travel"],route:"https://www.google.com/maps?q=Rishikesh+to+Dehradun&output=embed",hotel:{name:"Hotel Pacific",map:"#"},emergency:["DDN Hospital"],food:["Ellora"]},
{city:"Mussoorie ‚Üí Delhi",steps:["Return"],route:"https://www.google.com/maps?q=Mussoorie+to+Delhi&output=embed",hotel:{name:"‚Äî",map:"#"},emergency:["‚Äî"],food:["‚Äî"]}
];

let activeDay=0;
let participants=["Sahil","Patil"];
let expenses=JSON.parse(localStorage.getItem("expenses")||"[]");
let expenseLogs=JSON.parse(localStorage.getItem("expenseLogs")||"[]");
let cardsExpanded=JSON.parse(localStorage.getItem("cardsExpanded")||"false");

document.getElementById("expandToggle").checked=cardsExpanded;
document.getElementById("expandToggle").onchange=e=>{
  cardsExpanded=e.target.checked;
  localStorage.setItem("cardsExpanded",cardsExpanded);
  render();
};

function selectDay(i){activeDay=i;render();}
function toggle(el){el.parentElement.classList.toggle("expanded");}

function addLog(msg){
  expenseLogs.unshift(`[${new Date().toLocaleString()}] ${msg}`);
  localStorage.setItem("expenseLogs",JSON.stringify(expenseLogs));
}

function calculateSettlement(){
  const paid={};participants.forEach(p=>paid[p]=0);
  expenses.flat().forEach(e=>paid[e.by]+=e.amount);
  const total=Object.values(paid).reduce((a,b)=>a+b,0);
  const share=total/participants.length;
  return {total,share,paid};
}

function addExpense(){
  const t=et.value,a=+ea.value,by=eby.value;
  if(!t||!a)return;
  expenses[activeDay]=expenses[activeDay]||[];
  expenses[activeDay].push({title:t,amount:a,by});
  localStorage.setItem("expenses",JSON.stringify(expenses));
  addLog(`${by} added ‚Çπ${a} for ${t}`);
  render();
}

function removeExpense(i){
  const e=expenses[activeDay][i];
  expenses[activeDay].splice(i,1);
  localStorage.setItem("expenses",JSON.stringify(expenses));
  addLog(`${e.by} removed ‚Çπ${e.amount} for ${e.title}`);
  render();
}

function card(title,body){
  return `<div class="sectionCard ${cardsExpanded?"expanded":""}">
  <div class="sectionHeader" onclick="toggle(this)">${title}</div>
  <div class="sectionBody">${body}</div></div>`;
}

function render(){
  const d=days[activeDay];
  routeTitle.innerText=`${tripDates[activeDay]} ‚Äî ${d.city}`;

  document.querySelectorAll(".node").forEach((n,i)=>{
    n.classList.toggle("active",i===activeDay);
    n.dataset.tip=`${tripDates[i]} ‚Äî ${days[i].city}`;
  });

  vehicle.style.left=`calc(${activeDay*(100/5)}% - 10px)`;

  const {total,share,paid}=calculateSettlement();

  content.innerHTML=`
  ${card("üß≠ Step-by-step",`<ul>${d.steps.map(s=>`<li>${s}</li>`).join("")}</ul>`)}
  ${card("üó∫ Route Map",`<iframe src="${d.route}" width="100%" height="200"></iframe>`)}
  ${card("üè® Hotel",d.hotel.name)}
  ${card("üìù Notes",`<textarea></textarea>`)}
  ${card("üí≥ Expenses",`
    <input id="et" placeholder="Title">
    <input id="ea" type="number" placeholder="Amount">
    <select id="eby">${participants.map(p=>`<option>${p}</option>`).join("")}</select>
    <button onclick="addExpense()">Add</button>
    ${(expenses[activeDay]||[]).map((e,i)=>`
      <div>${e.title} ‚Çπ${e.amount} (${e.by})
      <button onclick="removeExpense(${i})">‚ùå</button></div>`).join("")}
  `)}
  ${card("üìä Settlement",`
    Total: ‚Çπ${total}<br>
    Per person: ‚Çπ${Math.round(share)}<hr>
    ${participants.map(p=>{
      const d=paid[p]-share;
      return d>0?`üü¢ ${p} gets ‚Çπ${Math.round(d)}`:`üî¥ ${p} pays ‚Çπ${Math.abs(Math.round(d))}`;
    }).join("<br>")}
  `)}
  ${card("üßæ Logs",expenseLogs.map(l=>`<div class="log">${l}</div>`).join("")||"No logs")}
  ${card("üöë Emergency",`<ul>${d.emergency.map(e=>`<li>${e}</li>`).join("")}</ul>`)}
  ${card("‚òï Food & Snacks",`<ul>${d.food.map(f=>`<li>${f}</li>`).join("")}</ul>`)}
  `;
}

render();
</script>
</body>
</html>
